# دليل إعداد الخادم الافتراضي الخاص (VPS) لمشروع صفحات الأخطاء

يهدف هذا الدليل إلى توضيح المتطلبات الأساسية والخطوات اليدوية اللازمة لإعداد خادم افتراضي خاص (VPS) لاستضافة مشروع صفحات الأخطاء. سيتم لاحقاً توفير سكربت تثبيت تلقائي لأتمتة هذه العملية، ولكن فهم الخطوات اليدوية ضروري لاستكشاف الأخطاء وإصلاحها وضمان بيئة مستقرة.

## 1. المتطلبات الأساسية للخادم الافتراضي الخاص (VPS)

لاستضافة مشروع React الذي يعتمد على Node.js، ستحتاج إلى خادم VPS يلبي الحد الأدنى من المتطلبات التالية:

### 1.1 نظام التشغيل

يوصى بشدة باستخدام توزيعة Linux مستقرة. الخيارات الشائعة والمناسبة لهذا الغرض تشمل:

*   **Ubuntu Server (الإصدارات LTS مثل 20.04 أو 22.04)**: يعتبر الخيار الأكثر شيوعاً نظراً لدعمه الواسع ومجتمعه النشط وتوفر حزم البرامج الحديثة.
*   **Debian**: خيار مستقر وموثوق به، وغالباً ما يكون أخف وزناً من Ubuntu.
*   **CentOS / Rocky Linux / AlmaLinux**: خيارات قوية ومستقرة للخوادم، خاصة إذا كنت تفضل بيئة تعتمد على Red Hat.

### 1.2 موارد الأجهزة

تعتمد الموارد المطلوبة على حجم حركة المرور المتوقعة. لمشروع صفحات الأخطاء، الذي يعتبر خفيف الوزن نسبياً، فإن الحد الأدنى من الموارد سيكون كافياً:

*   **المعالج (CPU)**: 1 vCPU (معالج افتراضي).
*   **الذاكرة العشوائية (RAM)**: 1 جيجابايت على الأقل. قد تحتاج إلى 2 جيجابايت إذا كنت تخطط لتشغيل خدمات إضافية على نفس الخادم.
*   **مساحة التخزين (Disk Space)**: 20 جيجابايت SSD على الأقل. يفضل استخدام أقراص SSD لضمان أداء أسرع.
*   **عرض النطاق الترددي (Bandwidth)**: 1 تيرابايت شهرياً على الأقل. هذا عادة ما يكون كافياً لمعظم حالات الاستخدام الأولية.

### 1.3 الوصول إلى الخادم

يجب أن يكون لديك وصول SSH (Secure Shell) إلى الخادم الخاص بك. هذا هو البروتوكول القياسي لإدارة الخوادم عن بعد بشكل آمن.

## 2. الخطوات اليدوية لإعداد الخادم

تتضمن هذه الخطوات إعداد بيئة الخادم وتثبيت التبعيات اللازمة لتشغيل تطبيق React.

### 2.1 الاتصال بالخادم عبر SSH

افتح محطة طرفية (Terminal) على جهاز الكمبيوتر الخاص بك واستخدم الأمر التالي للاتصال بالخادم:

```bash
ssh username@your_vps_ip_address
```

استبدل `username` باسم المستخدم الخاص بك على الخادم (غالباً ما يكون `root` أو `ubuntu`) و `your_vps_ip_address` بعنوان IP الخاص بخادمك.

### 2.2 تحديث نظام التشغيل

من الضروري تحديث قائمة الحزم وتثبيت أي تحديثات أمان أو إصلاحات للأخطاء. استخدم الأوامر التالية:

```bash
sudo apt update
sudo apt upgrade -y
```

*ملاحظة: إذا كنت تستخدم توزيعة تعتمد على Red Hat (مثل CentOS)، فاستخدم `sudo yum update -y` أو `sudo dnf update -y` بدلاً من ذلك.*

### 2.3 تثبيت Node.js و npm (أو pnpm)

مشروع React يتطلب بيئة تشغيل Node.js ومدير حزم مثل npm أو pnpm. يوصى باستخدام `pnpm` لأنه أسرع وأكثر كفاءة في استخدام مساحة القرص.

#### 2.3.1 تثبيت Node.js

الطريقة الموصى بها لتثبيت Node.js هي استخدام NodeSource PPA، والذي يوفر أحدث الإصدارات المستقرة.

```bash
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
sudo apt-get install -y nodejs
```

للتحقق من التثبيت:

```bash
node -v
npm -v
```

#### 2.3.2 تثبيت pnpm (اختياري وموصى به)

بعد تثبيت Node.js و npm، يمكنك تثبيت pnpm عالمياً:

```bash
sudo npm install -g pnpm
```

للتحقق من التثبيت:

```bash
pnpm -v
```

### 2.4 تثبيت Nginx (خادم الويب)

Nginx هو خادم ويب عالي الأداء سيتم استخدامه لتقديم الملفات الثابتة لتطبيق React الخاص بك والعمل كوكيل عكسي (Reverse Proxy) إذا لزم الأمر.

```bash
sudo apt install -y nginx
sudo systemctl start nginx
sudo systemctl enable nginx
```

للتحقق من حالة Nginx:

```bash
sudo systemctl status nginx
```

### 2.5 إعداد جدار الحماية (UFW)

جدار الحماية ضروري لتأمين الخادم الخاص بك. سنقوم بتمكين UFW والسماح بالاتصالات الضرورية.

```bash
sudo ufw enable
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow https
sudo ufw status
```

### 2.6 استنساخ المشروع من Git (إذا كان مستضافاً على Git)

إذا كان مشروعك مستضافاً على مستودع Git (مثل GitHub أو GitLab)، فستحتاج إلى استنساخه إلى الخادم:

```bash
cd /var/www/
# أو أي دليل تفضله
sudo git clone your_repository_url error-pages-project
```

استبدل `your_repository_url` بعنوان URL لمستودع Git الخاص بك.

### 2.7 تثبيت تبعيات المشروع وبنائه

انتقل إلى دليل المشروع وقم بتثبيت التبعيات وبناء المشروع للإنتاج:

```bash
cd /var/www/error-pages-project
pnpm install
pnpm run build
```

سيؤدي هذا إلى إنشاء مجلد `dist` (أو `build`) يحتوي على الملفات الثابتة الجاهزة للتقديم.

### 2.8 تكوين Nginx لتقديم تطبيق React

سنقوم بإنشاء ملف تكوين جديد لـ Nginx لتوجيه حركة المرور إلى مجلد `dist` الخاص بتطبيق React.

```bash
sudo nano /etc/nginx/sites-available/error-pages
```

أضف المحتوى التالي إلى الملف (استبدل `your_domain_or_ip` بعنوان IP الخاص بخادمك أو اسم النطاق الخاص بك):

```nginx
server {
    listen 80;
    listen [::]:80;
    server_name your_domain_or_ip;

    root /var/www/error-pages-project/dist;
    index index.html index.htm;

    location / {
        try_files $uri $uri/ /index.html;
    }

    error_page 404 /404.html;
    location = /404.html {
        internal;
    }

    # يمكنك إضافة تكوينات لصفحات الأخطاء الأخرى هنا إذا كنت تريد أن يتعامل Nginx معها مباشرة
    # error_page 403 /403.html;
    # location = /403.html {
    #     internal;
    # }
}
```

احفظ الملف واخرج (Ctrl+X, Y, Enter).

قم بإنشاء رابط رمزي (symlink) لتمكين هذا التكوين:

```bash
sudo ln -s /etc/nginx/sites-available/error-pages /etc/nginx/sites-enabled/
```

اختبر تكوين Nginx للتأكد من عدم وجود أخطاء:

```bash
sudo nginx -t
```

إذا كان الاختبار ناجحاً، أعد تشغيل Nginx لتطبيق التغييرات:

```bash
sudo systemctl restart nginx
```

### 2.9 (اختياري) إعداد HTTPS باستخدام Certbot

يوصى بشدة باستخدام HTTPS لتأمين موقعك. يمكنك الحصول على شهادة SSL/TLS مجانية من Let's Encrypt باستخدام Certbot.

```bash
sudo snap install core
sudo snap refresh core
sudo snap install --classic certbot
sudo ln -s /snap/bin/certbot /usr/bin/certbot
sudo certbot --nginx -d your_domain_name
```

اتبع التعليمات التي تظهر على الشاشة لإكمال إعداد HTTPS. سيقوم Certbot تلقائياً بتعديل تكوين Nginx الخاص بك.

## 3. التحقق من النشر

بعد إكمال الخطوات، يجب أن يكون تطبيق صفحات الأخطاء الخاص بك متاحاً عبر عنوان IP الخاص بخادمك أو اسم النطاق الذي قمت بتكوينه.

افتح متصفح الويب الخاص بك وانتقل إلى `http://your_vps_ip_address` أو `https://your_domain_name`.

يجب أن تشاهد الصفحة الرئيسية لمشروع صفحات الأخطاء. يمكنك بعد ذلك اختبار صفحات الأخطاء الفردية عن طريق الانتقال إلى المسارات المقابلة (مثل `/404`، `/403`، إلخ).

## 4. الخلاصة

يوفر هذا الدليل الخطوات الأساسية لإعداد خادم VPS يدوياً لاستضافة تطبيق React. على الرغم من أن هذه العملية قد تبدو معقدة في البداية، إلا أنها تمنحك فهماً عميقاً لكيفية عمل الأمور. في المرحلة التالية، سيتم توفير سكربت لأتمتة معظم هذه الخطوات، مما يسهل عملية النشر بشكل كبير.

